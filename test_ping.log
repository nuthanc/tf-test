+ TAGS=k8s_upgrade
+ [[ ! -z k8s_upgrade ]]
+ run_tests
+ testr_init
+ '[' '!' -d .testrepository ']'
+ /usr/local/bin/testr init
+ find . -type f -name '*.pyc' -delete
+ export PYTHONPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/contrail-test:/contrail-test/fixtures:/contrail-test/scripts
+ PYTHONPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/contrail-test:/contrail-test/fixtures:/contrail-test/scripts
+ export OS_TEST_PATH=./scripts/
+ OS_TEST_PATH=./scripts/
+ export DO_XMPP_CHECK=1
+ DO_XMPP_CHECK=1
+ '[' '!' -d ./scripts/ ']'
+ '[' 1 -eq 1 ']'
+ '[' k8s_upgrade = '' ']'
+ run_tagged_tests_in_debug_mode
+ list_tagged_tests
+ /usr/local/bin/testr list-tests
+ grep k8s_upgrade
+ /usr/bin/python3 tools/parse_test_file.py mylist
+ IFS='
'
+ read -d '' -r -a lines
+ count=1
+ for i in '"${lines[@]}"'
+ result_xml=result1.xml
+ (( count++ ))
+ '[' 1 -eq 1 ']'
+ pids[$count]=4632
+ wait_till_child_process_state 4632 stop
+ local pid=4632
+ local state=stop
+ true
+ [[ -f /proc/4632/status ]]
++ cat /proc/4632/task/4632/children
+ /usr/local/bin/subunit2junitxml -f -o result1.xml
+ exec /usr/bin/python3 -m subunit.run scripts.k8s_scripts.test_pod.TestPod.test_ping_between_two_pods
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4633 stop 0
+ local pid=4633
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4633/status ]]
++ grep State
++ cat /proc/4633/status
+ [[ State:	R (running) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4635 stop 0
+ local pid=4635
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4635/status ]]
++ grep State
++ cat /proc/4635/status
+ [[ State:	R (running) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ sleep 30
D��/usr/local/lib/python3.6/site-packages/kubernetes/config/kube_config.py:460: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  config_dict=yaml.load(f),
2021-07-14 11:54:48,222 - INFO - Using existing project ['default-domain', 'k8s-default'](67deeaf7-a377-4d59-9f7c-bb1d54be3080)
2021-07-14 11:54:48,310 - INFO - Using existing project ['default-domain', 'k8s-default'](67deeaf7-a377-4d59-9f7c-bb1d54be3080)
2021-07-14 11:54:48,655 - INFO - Verified VN network id 9 for VN 6152be6c-8c70-453a-9cf6-07a1e2e48d5a
2021-07-14 11:54:48,656 - INFO - Verifications in API Server for VN __public__ passed
2021-07-14 11:54:48,756 - INFO - On all control nodes, Config, RI and RT verification for VN __public__ passed
2021-07-14 11:54:49,105 - INFO - Validated that VN default-domain:k8s-default:__public__ is found in opserver
2021-07-14 11:54:49,160 - INFO - Created public VN:__public__
2021-07-14 11:54:49,411 - INFO - Verification for FIP pool __fip_pool_public__ in API Server passed
2021-07-14 11:54:49,450 - INFO - Verification for FIP pool __fip_pool_public__ in Control-node passed
2021-07-14 11:54:49,450 - INFO - Created FIP Pool:__fip_pool_public__ under Project:k8s-default
2021-07-14 11:54:49,509 - INFO - Control nodel 77.77.1.20 already present, not creating it
2021-07-14 11:54:49,579 - INFO - Control nodel 77.77.1.30 already present, not creating it
2021-07-14 11:54:49,655 - INFO - Control nodel 77.77.1.11 already present, not creating it
2021-07-14 11:54:49,719 - INFO - Control nodel 77.77.1.100 already present, not creating it
2021-07-14 11:54:49,731 - INFO - With Peer hooper peering is Current State is Established
2021-07-14 11:54:49,731 - INFO - With Peer nodec23 peering is Current State is Established
2021-07-14 11:54:49,731 - INFO - With Peer nodeg31 peering is Current State is Established
2021-07-14 11:54:49,752 - INFO - With Peer hooper peering is Current State is Established
2021-07-14 11:54:49,752 - INFO - With Peer nodea4 peering is Current State is Established
2021-07-14 11:54:49,752 - INFO - With Peer nodec23 peering is Current State is Established
2021-07-14 11:54:49,772 - INFO - With Peer hooper peering is Current State is Established
2021-07-14 11:54:49,773 - INFO - With Peer nodea4 peering is Current State is Established
2021-07-14 11:54:49,773 - INFO - With Peer nodeg31 peering is Current State is Established
�+@�`�Љ��@rscripts.k8s_scripts.test_pod.TestPod.test_ping_between_two_pods[ci_contrail_go_k8s_sanity,k8s_upgrade,openshift_1]J�Q2021-07-14 11:54:49,777 - INFO - ================================================================================
2021-07-14 11:54:49,777 - INFO - STARTING TEST    : test_ping_between_two_pods
2021-07-14 11:54:49,778 - INFO - TEST DESCRIPTION :
        Test ping between 2 PODs

2021-07-14 11:54:51,083 - WARNING - Test is running with cores: {'10.204.216.120': ['core.contrail-collec.1.nodea4.1626164364'], '10.204.217.71': ['core.contrail-collec.1.nodeg31.1626164364']}
2021-07-14 11:54:51,109 - INFO - Initial checks done. Running the testcase now
2021-07-14 11:54:51,109 - INFO -
2021-07-14 11:54:51,115 - INFO - Creating Pod ctest-busybox-pod-30572779
2021-07-14 11:55:01,172 - INFO - Pod ctest-busybox-pod-30572779 is in running state.Got IP 10.47.255.246
2021-07-14 11:55:01,189 - INFO - Verified pod ctest-busybox-pod-30572779 in contrail-api
2021-07-14 11:55:01,203 - INFO - Verified Pod ctest-busybox-pod-30572779 in agent 10.204.217.4
2021-07-14 11:55:01,657 - INFO - Pod ctest-busybox-pod-30572779 with uuid 4bb59a50-e49a-11eb-a1b3-002590a53b13 found in kube manager
2021-07-14 11:55:01,657 - INFO - Pod ctest-busybox-pod-30572779 verification passed
2021-07-14 11:55:01,667 - INFO - Creating Pod ctest-busybox-pod-81620275
+ true
+ [[ -f /proc/4632/status ]]
++ cat /proc/4632/task/4632/children
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4633 stop 0
+ local pid=4633
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4633/status ]]
++ cat /proc/4633/status
++ grep State
+ [[ State:	S (sleeping) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4635 stop 0
+ local pid=4635
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4635/status ]]
++ cat /proc/4635/status
++ grep State
+ [[ State:	S (sleeping) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ sleep 30
2021-07-14 11:55:11,733 - INFO - Pod ctest-busybox-pod-81620275 is in running state.Got IP 10.47.255.245
2021-07-14 11:55:11,755 - INFO - Verified pod ctest-busybox-pod-81620275 in contrail-api
2021-07-14 11:55:11,773 - INFO - Verified Pod ctest-busybox-pod-81620275 in agent 10.204.217.6
2021-07-14 11:55:11,782 - INFO - Pod ctest-busybox-pod-81620275 with uuid 51ff5b96-e49a-11eb-a1b3-002590a53b13 found in kube manager
2021-07-14 11:55:11,782 - INFO - Pod ctest-busybox-pod-81620275 verification passed
2021-07-14 11:55:13,873 - INFO - Ping check to IP 10.47.255.245 from pod ctest-busybox-pod-30572779 with expectation True passed
2021-07-14 11:55:13,873 - INFO - UPGRADE: test_ping_between_two_pods[4633]: Stopping self
2021-07-14 11:55:13,873 - INFO - --------------------------------------------------------------------------------
+ true
+ [[ -f /proc/4632/status ]]
++ cat /proc/4632/task/4632/children
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4633 stop 0
+ local pid=4633
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4633/status ]]
++ cat /proc/4633/status
++ grep State
+ [[ State:	T (stopped) != *stop* ]]
+ break
+ return 0
+ for i in '"${lines[@]}"'
+ result_xml=result2.xml
+ (( count++ ))
+ '[' 1 -eq 1 ']'
+ pids[$count]=4662
+ wait_till_child_process_state 4662 stop
+ local pid=4662
+ local state=stop
+ true
+ [[ -f /proc/4662/status ]]
+ exec /usr/bin/python3 -m subunit.run scripts.k8s_scripts.test_pod.TestPodVNIsolated.test_ping_between_two_pods
+ /usr/local/bin/subunit2junitxml -f -o result2.xml
++ cat /proc/4662/task/4662/children
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4663 stop 0
+ local pid=4663
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4663/status ]]
++ grep State
++ cat /proc/4663/status
+ [[ State:	R (running) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4664 stop 0
+ local pid=4664
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4664/status ]]
++ grep State
++ cat /proc/4664/status
+ [[ State:	R (running) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ sleep 30
�)@�@|scripts.k8s_scripts.test_pod.TestPodVNIsolated.test_ping_between_two_pods[ci_contrail_go_k8s_sanity,k8s_upgrade,openshift_1]�p��/usr/local/lib/python3.6/site-packages/kubernetes/config/kube_config.py:460: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  config_dict=yaml.load(f),
2021-07-14 11:55:48,339 - INFO - Using existing project ['default-domain', 'k8s-default'](67deeaf7-a377-4d59-9f7c-bb1d54be3080)
2021-07-14 11:55:48,437 - INFO - Using existing project ['default-domain', 'k8s-default'](67deeaf7-a377-4d59-9f7c-bb1d54be3080)
2021-07-14 11:55:48,764 - INFO - Verified VN network id 9 for VN 6152be6c-8c70-453a-9cf6-07a1e2e48d5a
2021-07-14 11:55:48,764 - INFO - Verifications in API Server for VN __public__ passed
2021-07-14 11:55:48,875 - INFO - On all control nodes, Config, RI and RT verification for VN __public__ passed
2021-07-14 11:55:49,237 - INFO - Validated that VN default-domain:k8s-default:__public__ is found in opserver
2021-07-14 11:55:49,289 - INFO - Created public VN:__public__
2021-07-14 11:55:49,562 - INFO - Verification for FIP pool __fip_pool_public__ in API Server passed
2021-07-14 11:55:49,599 - INFO - Verification for FIP pool __fip_pool_public__ in Control-node passed
2021-07-14 11:55:49,599 - INFO - Created FIP Pool:__fip_pool_public__ under Project:k8s-default
2021-07-14 11:55:49,657 - INFO - Control nodel 77.77.1.20 already present, not creating it
2021-07-14 11:55:49,714 - INFO - Control nodel 77.77.1.30 already present, not creating it
2021-07-14 11:55:49,771 - INFO - Control nodel 77.77.1.11 already present, not creating it
2021-07-14 11:55:49,830 - INFO - Control nodel 77.77.1.100 already present, not creating it
2021-07-14 11:55:49,847 - INFO - With Peer hooper peering is Current State is Established
2021-07-14 11:55:49,848 - INFO - With Peer nodec23 peering is Current State is Established
2021-07-14 11:55:49,848 - INFO - With Peer nodeg31 peering is Current State is Established
2021-07-14 11:55:49,869 - INFO - With Peer hooper peering is Current State is Established
2021-07-14 11:55:49,870 - INFO - With Peer nodea4 peering is Current State is Established
2021-07-14 11:55:49,870 - INFO - With Peer nodec23 peering is Current State is Established
2021-07-14 11:55:49,890 - INFO - With Peer hooper peering is Current State is Established
2021-07-14 11:55:49,891 - INFO - With Peer nodea4 peering is Current State is Established
2021-07-14 11:55:49,891 - INFO - With Peer nodeg31 peering is Current State is Established
�+@�`����'� @|scripts.k8s_scripts.test_pod.TestPodVNIsolated.test_ping_between_two_pods[ci_contrail_go_k8s_sanity,k8s_upgrade,openshift_1]��C�2021-07-14 11:55:49,895 - INFO - ================================================================================
2021-07-14 11:55:49,896 - INFO - STARTING TEST    : test_ping_between_two_pods
2021-07-14 11:55:49,897 - INFO - TEST DESCRIPTION :
        Test ping between 2 PODs

2021-07-14 11:55:51,203 - WARNING - Test is running with cores: {'10.204.216.120': ['core.contrail-collec.1.nodea4.1626164364'], '10.204.217.71': ['core.contrail-collec.1.nodeg31.1626164364']}
2021-07-14 11:55:51,230 - INFO - Initial checks done. Running the testcase now
2021-07-14 11:55:51,230 - INFO -
2021-07-14 11:55:51,236 - INFO - Creating Pod ctest-busybox-pod-47081214
2021-07-14 11:56:01,291 - INFO - Pod ctest-busybox-pod-47081214 is in running state.Got IP 10.47.255.244
2021-07-14 11:56:01,314 - INFO - Verified pod ctest-busybox-pod-47081214 in contrail-api
2021-07-14 11:56:01,333 - INFO - Verified Pod ctest-busybox-pod-47081214 in agent 10.204.217.6
2021-07-14 11:56:01,795 - INFO - Pod ctest-busybox-pod-47081214 with uuid 6f8b3389-e49a-11eb-a1b3-002590a53b13 found in kube manager
2021-07-14 11:56:01,795 - INFO - Pod ctest-busybox-pod-47081214 verification passed
2021-07-14 11:56:01,800 - INFO - Creating Pod ctest-busybox-pod-66904376
+ true
+ [[ -f /proc/4662/status ]]
++ cat /proc/4662/task/4662/children
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4663 stop 0
+ local pid=4663
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4663/status ]]
++ cat /proc/4663/status
++ grep State
+ [[ State:	S (sleeping) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4664 stop 0
+ local pid=4664
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4664/status ]]
++ cat /proc/4664/status
++ grep State
+ [[ State:	S (sleeping) != *stop* ]]
+ '[' 0 -eq 1 ']'
+ return 1
+ sleep 30
2021-07-14 11:56:11,846 - INFO - Pod ctest-busybox-pod-66904376 is in running state.Got IP 10.47.255.243
2021-07-14 11:56:11,870 - INFO - Verified pod ctest-busybox-pod-66904376 in contrail-api
2021-07-14 11:56:11,890 - INFO - Verified Pod ctest-busybox-pod-66904376 in agent 10.204.217.6
2021-07-14 11:56:11,898 - INFO - Pod ctest-busybox-pod-66904376 with uuid 75d6b9e8-e49a-11eb-a1b3-002590a53b13 found in kube manager
2021-07-14 11:56:11,898 - INFO - Pod ctest-busybox-pod-66904376 verification passed
2021-07-14 11:56:13,988 - INFO - Ping check to IP 10.47.255.243 from pod ctest-busybox-pod-47081214 with expectation True passed
2021-07-14 11:56:13,988 - INFO - UPGRADE: test_ping_between_two_pods[4663]: Stopping self
2021-07-14 11:56:13,988 - INFO - --------------------------------------------------------------------------------
+ true
+ [[ -f /proc/4662/status ]]
++ cat /proc/4662/task/4662/children
+ for cpid in '$(cat /proc/$pid/task/$pid/children)'
+ wait_till_process_state 4663 stop 0
+ local pid=4663
+ local state=stop
+ local wait=0
+ true
+ [[ -f /proc/4663/status ]]
++ cat /proc/4663/status
++ grep State
+ [[ State:	T (stopped) != *stop* ]]
+ break
+ return 0
+ '[' 1 -eq 1 ']'
+ wait